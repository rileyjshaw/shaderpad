import{a as v}from"./chunk-LXQJ4NRK.mjs";var U=`#version 300 es
in vec2 a_position;
out vec2 v_uv;
void main() {
    gl_Position = vec4(a_position, 0.0, 1.0);
    v_uv = a_position * 0.5 + 0.5;
}`,G=[["8UI","UNSIGNED_BYTE"],["8I","BYTE"],["16UI","UNSIGNED_SHORT"],["16I","SHORT"],["16F","HALF_FLOAT"],["32UI","UNSIGNED_INT"],["32I","INT"],["32F","FLOAT"],["8","UNSIGNED_BYTE"]];function P(h){return h&&G.find(([t])=>h.endsWith(t))?.[1]}var R=Symbol("u_history"),p=Symbol("__SHADERPAD_BUFFER"),F=new WeakMap;function D(h,t){if(!t?.length)return h;let e=h.split(`
`),i=e.findLastIndex(r=>{let s=r.trimStart();return s.startsWith("precision ")||s.startsWith("#version ")})+1;return e.splice(i,0,...t),e.join(`
`)}function S(h){return h instanceof WebGLTexture?{width:0,height:0}:h instanceof A?{width:h.canvas.width,height:h.canvas.height}:h instanceof HTMLVideoElement?{width:h.videoWidth,height:h.videoHeight}:h instanceof HTMLImageElement?{width:h.naturalWidth??h.width,height:h.naturalHeight??h.height}:{width:h.width,height:h.height}}function x(h){return typeof h=="symbol"?h.description??"":h}var A=class h{isHeadless=!1;isTouchDevice=!1;gl;glHelpers;uniforms=new Map;textures=new Map;textureUnitPool;buffer=null;vao=null;program=null;animationFrameId;eventListeners=new Map;frame=0;startTime=0;isPlaying=!1;cursorPosition=[.5,.5];clickPosition=[.5,.5];isMouseDown=!1;canvas;resolutionObserver=null;hooks=new Map;historyDepth=0;textureOptions;debug;cursorTarget;intermediateFbo=null;constructor(t,{canvas:e,plugins:i,history:r,debug:s,cursorTarget:a,...o}={}){if(e&&"getContext"in e)this.canvas=e;else{let{width:d=1,height:m=1}=e||{};this.canvas=new OffscreenCanvas(d,m),this.isHeadless=!0}let n=this.canvas.getContext("webgl2",{antialias:!1});if(!n)throw new Error("WebGL2 not supported. Please use a browser that supports WebGL2.");this.gl=n,this.glHelpers={typeToArray:new Map([[n.FLOAT,Float32Array],[n.HALF_FLOAT,Uint16Array],[n.UNSIGNED_SHORT,Uint16Array],[n.SHORT,Int16Array],[n.BYTE,Int8Array],[n.UNSIGNED_INT,Uint32Array],[n.INT,Int32Array]]),typeToInternalFormatString:new Map([[n.FLOAT,"RGBA32F"],[n.HALF_FLOAT,"RGBA16F"],[n.UNSIGNED_SHORT,"RGBA32UI"],[n.SHORT,"RGBA32I"],[n.BYTE,"RGBA32I"],[n.UNSIGNED_INT,"RGBA32UI"],[n.INT,"RGBA32I"]]),unsignedIntTypes:new Set([n.UNSIGNED_BYTE,n.UNSIGNED_SHORT,n.UNSIGNED_INT])};let l=F.get(this.canvas);l||(l={textureUnitPool:{free:[],next:0,max:n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS)},instances:new Set([this])},F.set(this.canvas,l)),this.textureUnitPool=l.textureUnitPool,l.instances.add(this),this.textureOptions=o,r&&(this.historyDepth=r),this.debug=s??(typeof process<"u"&&!1),this.cursorTarget=a??(this.canvas instanceof HTMLCanvasElement?this.canvas:void 0),this.animationFrameId=null;let u=[];i&&i.forEach(d=>d(this,{gl:n,canvas:this.canvas,injectGLSL:m=>{u.push(m)},emitHook:this.emitHook.bind(this)}));let g=this.gl.createProgram();if(!g)throw new Error("Failed to create WebGL program");this.program=g;let f=this.createShader(this.gl.VERTEX_SHADER,U),T=this.createShader(n.FRAGMENT_SHADER,D(t,u));if(n.attachShader(g,f),n.attachShader(g,T),n.bindAttribLocation(g,0,"a_position"),n.linkProgram(g),n.deleteShader(f),n.deleteShader(T),!n.getProgramParameter(g,n.LINK_STATUS))throw console.error("Program link error:",n.getProgramInfoLog(g)),n.deleteProgram(g),new Error("Failed to link WebGL program");if(this.vao=n.createVertexArray(),n.bindVertexArray(this.vao),this.buffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.buffer),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,3,-1,-1,3]),n.STATIC_DRAW),n.enableVertexAttribArray(0),n.vertexAttribPointer(0,2,n.FLOAT,!1,0,0),n.viewport(0,0,n.drawingBufferWidth,n.drawingBufferHeight),n.useProgram(g),this.canvas instanceof HTMLCanvasElement)this.resolutionObserver=new MutationObserver(()=>this.updateResolution()),this.resolutionObserver.observe(this.canvas,{attributes:!0,attributeFilter:["width","height"]});else{let d=m=>{let c=Object.getOwnPropertyDescriptor(OffscreenCanvas.prototype,m),E=this.canvas;Object.defineProperty(E,m,{get:()=>c.get.call(E),set:I=>{c.set.call(E,I);let b=F.get(E);if(b)for(let y of b.instances)y.updateResolution()},configurable:c.configurable,enumerable:c.enumerable})};d("width"),d("height")}this.updateResolution(),this.initializeUniform("u_cursor","float",this.cursorPosition),this.initializeUniform("u_click","float",[...this.clickPosition,this.isMouseDown?1:0]),this.initializeUniform("u_time","float",0),this.initializeUniform("u_frame","int",0),this._initializeTexture(p,this.canvas,{...this.textureOptions}),this.intermediateFbo=n.createFramebuffer(),this.bindIntermediate(),n.bindFramebuffer(n.FRAMEBUFFER,null),this.historyDepth>0&&this._initializeTexture(R,this.canvas,{history:this.historyDepth,...this.textureOptions}),this.cursorTarget&&this.addEventListeners(),this.emitHook("_init")}resolveGLConstant(t){let e=this.gl[t];if(e===void 0)throw new Error(`Unknown GL constant: ${t}`);return e}emitHook(t,...e){this.hooks.get(t)?.forEach(i=>i.call(this,...e))}on(t,e){this.hooks.has(t)||this.hooks.set(t,[]),this.hooks.get(t).push(e)}off(t,e){let i=this.hooks.get(t);i&&i.splice(i.indexOf(e),1)}createShader(t,e){let i=this.gl.createShader(t);if(this.gl.shaderSource(i,e),this.gl.compileShader(i),!this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS))throw console.error("Shader compilation failed:",e),console.error(this.gl.getShaderInfoLog(i)),this.gl.deleteShader(i),new Error("Shader compilation failed");return i}getCursorTargetRect(){let t=this.cursorTarget;return t===window?{left:0,top:0,width:window.innerWidth,height:window.innerHeight}:t.getBoundingClientRect()}addEventListeners(){if(!this.cursorTarget)return;let t=(i,r)=>{if(!this.uniforms.has("u_cursor"))return;let s=this.getCursorTargetRect(),a=(i-s.left)/s.width,o=1-(r-s.top)/s.height;this.cursorPosition[0]=Math.max(0,Math.min(1,a)),this.cursorPosition[1]=Math.max(0,Math.min(1,o)),this.updateUniforms({u_cursor:this.cursorPosition})},e=(i,r,s)=>{if(this.uniforms.has("u_click")){if(this.isMouseDown=i,i){let a=this.getCursorTargetRect(),o=r,n=s;this.clickPosition[0]=Math.max(0,Math.min(1,(o-a.left)/a.width)),this.clickPosition[1]=Math.max(0,Math.min(1,1-(n-a.top)/a.height))}this.updateUniforms({u_click:[...this.clickPosition,this.isMouseDown?1:0]})}};this.eventListeners.set("mousemove",i=>{let r=i;this.isTouchDevice||t(r.clientX,r.clientY)}),this.eventListeners.set("mousedown",i=>{let r=i;this.isTouchDevice||r.button===0&&(this.isMouseDown=!0,e(!0,r.clientX,r.clientY))}),this.eventListeners.set("mouseup",i=>{let r=i;this.isTouchDevice||r.button===0&&e(!1)}),this.eventListeners.set("touchmove",i=>{let r=i;r.touches.length>0&&t(r.touches[0].clientX,r.touches[0].clientY)}),this.eventListeners.set("touchstart",i=>{let r=i;this.isTouchDevice=!0,r.touches.length>0&&(t(r.touches[0].clientX,r.touches[0].clientY),e(!0,r.touches[0].clientX,r.touches[0].clientY))}),this.eventListeners.set("touchend",i=>{i.touches.length===0&&e(!1)}),this.eventListeners.forEach((i,r)=>{this.cursorTarget.addEventListener(r,i)})}updateResolution(){let t=[this.gl.drawingBufferWidth,this.gl.drawingBufferHeight];this.gl.viewport(0,0,...t),this.uniforms.has("u_resolution")?this.updateUniforms({u_resolution:t}):this.initializeUniform("u_resolution","float",t),this.resizeTexture(p,...t),this.historyDepth>0&&this.resizeTexture(R,...t),this.emitHook("updateResolution",...t)}resizeTexture(t,e,i){let r=this.textures.get(t);if(!r||r.width===e&&r.height===i)return;this.gl.deleteTexture(r.texture),r.width=e,r.height=i;let{texture:s}=this.createTexture(t,r);r.texture=s,r.history&&(r.history.writeIndex=0,this.clearHistoryTextureLayers(r))}reserveTextureUnit(t){let e=this.textures.get(t);if(e)return e.unitIndex;if(this.textureUnitPool.free.length>0)return this.textureUnitPool.free.pop();if(this.textureUnitPool.next>=this.textureUnitPool.max)throw new Error("Exceeded the available texture units for this device.");return this.textureUnitPool.next++}resolveTextureOptions(t){let{gl:e}=this,i=t?.internalFormat,r=t?.type??P(i)??"UNSIGNED_BYTE",s=this.resolveGLConstant(r),a=i??this.glHelpers.typeToInternalFormatString.get(s)??"RGBA8",o=/^(R|RG|RGB|RGBA)(8|16|32)(UI|I)$/.test(a),n=t?.format??(o?"RGBA_INTEGER":"RGBA"),l={type:s,format:this.resolveGLConstant(n),internalFormat:this.resolveGLConstant(a),minFilter:this.resolveGLConstant(t?.minFilter??"LINEAR"),magFilter:this.resolveGLConstant(t?.magFilter??"LINEAR"),wrapS:this.resolveGLConstant(t?.wrapS??"CLAMP_TO_EDGE"),wrapT:this.resolveGLConstant(t?.wrapT??"CLAMP_TO_EDGE"),preserveY:t?.preserveY,isIntegerColorFormat:o};if((l.internalFormat===e.RGBA16F||l.internalFormat===e.RGBA32F)&&!e.getExtension("EXT_color_buffer_float"))throw new Error("Missing EXT_color_buffer_float.");return l}getPixelArray(t,e){let i=this.glHelpers.typeToArray.get(t)??Uint8Array;return new i(e)}clearHistoryTextureLayers(t){if(!t.history)return;let e=this.gl,{type:i,format:r}=t.options,s=this.getPixelArray(i,t.width*t.height*4);e.activeTexture(e.TEXTURE0+t.unitIndex),e.bindTexture(e.TEXTURE_2D_ARRAY,t.texture);for(let a=0;a<t.history.depth;++a)e.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,a,t.width,t.height,1,r,i,s)}initializeUniform(t,e,i,r){let s=r?.arrayLength;if(this.uniforms.has(t))throw new Error(`${t} is already initialized.`);if(e!=="float"&&e!=="int")throw new Error(`Invalid uniform type: ${e}. Expected 'float' or 'int'.`);if(s&&!(Array.isArray(i)&&i.length===s))throw new Error(`${t} array length mismatch: must initialize with ${s} elements.`);let a=this.gl.getUniformLocation(this.program,t);if(!a&&s&&(a=this.gl.getUniformLocation(this.program,`${t}[0]`)),!a){this.log(`${t} not in shader. Skipping initialization.`);return}let o=s?i[0]:i,n=Array.isArray(o)?o.length:1;this.uniforms.set(t,{type:e,length:n,location:a,arrayLength:s});try{this.updateUniforms({[t]:i})}catch(l){throw this.uniforms.delete(t),l}this.emitHook("initializeUniform",...arguments)}log(...t){this.debug&&console.debug(...t)}updateUniforms(t,e){this.gl.useProgram(this.program),Object.entries(t).forEach(([i,r])=>{let s=this.uniforms.get(i);if(!s){this.log(`${i} not in shader. Skipping update.`);return}let a=`uniform${s.length}${s.type.charAt(0)}`;if(s.arrayLength){if(!Array.isArray(r))throw new Error(`${i} is an array, but the value passed to updateUniforms is not an array.`);let o=r.length;if(!o)return;if(o>s.arrayLength)throw new Error(`${i} received ${o} values, but maximum length is ${s.arrayLength}.`);if(r.some(u=>(Array.isArray(u)?u.length:1)!==s.length))throw new Error(`Tried to update ${i} with some elements that are not length ${s.length}.`);let n=new(s.type==="float"?Float32Array:Int32Array)(r.flat()),l=s.location;if(e?.startIndex){let u=this.gl.getUniformLocation(this.program,`${i}[${e.startIndex}]`);if(!u)throw new Error(`${i}[${e.startIndex}] not in shader. Did you pass an invalid startIndex?`);l=u}this.gl[a+"v"](l,n)}else{if(Array.isArray(r)||(r=[r]),r.length!==s.length)throw new Error(`Invalid uniform value length: ${r.length}. Expected ${s.length}.`);this.gl[a](s.location,...r)}}),this.emitHook("updateUniforms",...arguments)}createTexture(t,e){let{width:i,height:r}=e,s=e.history?.depth??0,a=this.gl.createTexture();if(!a)throw new Error("Failed to create texture");let o=e.unitIndex;if(typeof o!="number")try{o=this.reserveTextureUnit(t)}catch(g){throw this.gl.deleteTexture(a),g}let n=s>0,l=n?this.gl.TEXTURE_2D_ARRAY:this.gl.TEXTURE_2D,{options:u}=e;return this.gl.activeTexture(this.gl.TEXTURE0+o),this.gl.bindTexture(l,a),this.gl.texParameteri(l,this.gl.TEXTURE_WRAP_S,u.wrapS),this.gl.texParameteri(l,this.gl.TEXTURE_WRAP_T,u.wrapT),this.gl.texParameteri(l,this.gl.TEXTURE_MIN_FILTER,u.minFilter),this.gl.texParameteri(l,this.gl.TEXTURE_MAG_FILTER,u.magFilter),n?this.gl.texStorage3D(l,1,u.internalFormat,i,r,s):t===p&&this.gl.texImage2D(this.gl.TEXTURE_2D,0,u.internalFormat,i,r,0,u.format,u.type,null),{texture:a,unitIndex:o}}_initializeTexture(t,e,i){if(this.textures.has(t))throw new Error(`Texture '${x(t)}' is already initialized.`);let{history:r=0,...s}=i??{},{width:a,height:o}=S(e);if(!a||!o)throw new Error("Texture source must have valid dimensions");let n={width:a,height:o,options:e instanceof h&&Object.keys(s).length===0&&e.textures.has(p)?e.textures.get(p).options:this.resolveTextureOptions(s)};r>0&&(n.history={depth:r,writeIndex:0});let{texture:l,unitIndex:u}=this.createTexture(t,n),g={texture:l,unitIndex:u,...n};r>0&&(this.initializeUniform(`${x(t)}FrameOffset`,"int",0),this.clearHistoryTextureLayers(g)),this.textures.set(t,g),t!==p&&t!==R&&this.updateTexture(t,e),this.gl.useProgram(this.program);let f=this.gl.getUniformLocation(this.program,x(t));f&&this.gl.uniform1i(f,u)}initializeTexture(t,e,i){let r=i?.history!=null&&i.history>0?{...i,history:i.history+1}:i;this._initializeTexture(t,e,r),this.emitHook("initializeTexture",...arguments)}updateTextures(t,e){Object.entries(t).forEach(([i,r])=>{this.updateTexture(i,r,e)}),this.emitHook("updateTextures",...arguments)}updateTexture(t,e,i){let r=this.textures.get(t);if(!r)throw new Error(`Texture '${x(t)}' is not initialized.`);if(e instanceof WebGLTexture){this.gl.activeTexture(this.gl.TEXTURE0+r.unitIndex),this.gl.bindTexture(this.gl.TEXTURE_2D,e);return}let s=e;if(e instanceof h){let f=e.textures.get(p),T=f.width,d=f.height;if(e.gl===this.gl){if(!r.history){this.gl.activeTexture(this.gl.TEXTURE0+r.unitIndex),this.gl.bindTexture(this.gl.TEXTURE_2D,f.texture);return}let{depth:y}=r.history,_=i?.historyWriteIndex===void 0?[r.history.writeIndex]:Array.isArray(i?.historyWriteIndex)?i.historyWriteIndex.map(L=>v(L,y)):[v(i.historyWriteIndex,y)];this.gl.bindFramebuffer(this.gl.READ_FRAMEBUFFER,e.intermediateFbo),this.gl.bindTexture(this.gl.TEXTURE_2D_ARRAY,r.texture);for(let L of _)this.gl.copyTexSubImage3D(this.gl.TEXTURE_2D_ARRAY,0,0,0,L,0,0,T,d);this.gl.bindFramebuffer(this.gl.READ_FRAMEBUFFER,null),this.gl.activeTexture(this.gl.TEXTURE0+r.unitIndex),this.gl.bindTexture(this.gl.TEXTURE_2D_ARRAY,r.texture);let w=`${x(t)}FrameOffset`;this.updateUniforms({[w]:_[_.length-1]}),i?.historyWriteIndex===void 0&&(r.history.writeIndex=(r.history.writeIndex+1)%y);return}let{width:m,height:c,options:{format:E,type:I}}=f,b=this.getPixelArray(I,m*c*4);e.gl.bindFramebuffer(e.gl.FRAMEBUFFER,e.intermediateFbo),e.gl.readPixels(0,0,m,c,E,I,b),e.gl.bindFramebuffer(e.gl.FRAMEBUFFER,null),s={data:b,width:m,height:c}}let{width:a,height:o}=S(s);if(!a||!o)return;let n="isPartial"in s&&s.isPartial;n||this.resizeTexture(t,a,o);let u=!("data"in s&&s.data)&&!r.options?.preserveY,g=this.gl.getParameter(this.gl.UNPACK_FLIP_Y_WEBGL);if(r.history){if(this.gl.activeTexture(this.gl.TEXTURE0+r.unitIndex),this.gl.bindTexture(this.gl.TEXTURE_2D_ARRAY,r.texture),!i?.skipHistoryWrite){let{depth:f}=r.history,T=i?.historyWriteIndex===void 0?[r.history.writeIndex]:Array.isArray(i.historyWriteIndex)?i.historyWriteIndex.map(c=>v(c,f)):[v(i.historyWriteIndex,f)];this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,u);let d=s.data??s;for(let c of T)this.gl.texSubImage3D(this.gl.TEXTURE_2D_ARRAY,0,0,0,c,a,o,1,r.options.format,r.options.type,d);this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,g);let m=`${x(t)}FrameOffset`;this.updateUniforms({[m]:T[T.length-1]}),i?.historyWriteIndex===void 0&&(r.history.writeIndex=(r.history.writeIndex+1)%f)}}else{if(this.gl.activeTexture(this.gl.TEXTURE0+r.unitIndex),this.gl.bindTexture(this.gl.TEXTURE_2D,r.texture),this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,u),n){let f=s;this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,f.x??0,f.y??0,a,o,r.options.format,r.options.type,f.data)}else this.gl.texImage2D(this.gl.TEXTURE_2D,0,r.options.internalFormat,a,o,0,r.options.format,r.options.type,s.data??s);this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,g)}}bindIntermediate(){let t=this.gl,e=this.textures.get(p);t.bindFramebuffer(t.FRAMEBUFFER,this.intermediateFbo),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.texture,0)}clear(){this.bindIntermediate();let t=this.gl,e=this.textures.get(p);if(e.options.isIntegerColorFormat){let i=e.options.type;this.glHelpers.unsignedIntTypes.has(i)?t.clearBufferuiv(t.COLOR,0,new Uint32Array(4)):t.clearBufferiv(t.COLOR,0,new Int32Array(4))}else t.clear(t.COLOR_BUFFER_BIT)}draw(t){this.emitHook("beforeDraw",...arguments);let e=this.gl,i=e.drawingBufferWidth,r=e.drawingBufferHeight;t?.skipClear?this.bindIntermediate():this.clear(),e.useProgram(this.program),e.bindVertexArray(this.vao),e.viewport(0,0,i,r),e.drawArrays(e.TRIANGLES,0,3),this.isHeadless||this.textures.get(p).options.isIntegerColorFormat||(e.bindFramebuffer(e.READ_FRAMEBUFFER,this.intermediateFbo),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.blitFramebuffer(0,0,i,r,0,0,i,r,e.COLOR_BUFFER_BIT,e.NEAREST),e.bindFramebuffer(e.FRAMEBUFFER,null)),this.emitHook("afterDraw",...arguments)}step(t){this._step(performance.now()-this.startTime,t)}_step(t,e){this.emitHook("beforeStep",t,this.frame,e);let i={};this.uniforms.has("u_time")&&(i.u_time=t),this.uniforms.has("u_frame")&&(i.u_frame=this.frame),this.updateUniforms(i),this.draw(e);let r=this.textures.get(R);if(r&&!e?.skipHistoryWrite){let{writeIndex:s,depth:a}=r.history,o=this.gl;o.bindFramebuffer(o.READ_FRAMEBUFFER,this.intermediateFbo),o.bindTexture(o.TEXTURE_2D_ARRAY,r.texture),o.copyTexSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,s,0,0,o.drawingBufferWidth,o.drawingBufferHeight),o.bindFramebuffer(o.READ_FRAMEBUFFER,null);let n=(s+1)%a;this.updateUniforms({[`${x(R)}FrameOffset`]:n}),r.history.writeIndex=n}++this.frame,this.emitHook("afterStep",t,this.frame,e)}play(t){this.pause(),this.isPlaying=!0;let e=i=>{i=(i-this.startTime)/1e3;let r=t?.(i,this.frame)??void 0;this._step(i,r),this.isPlaying&&(this.animationFrameId=requestAnimationFrame(e))};this.animationFrameId=requestAnimationFrame(e),this.emitHook("play")}_pause(){this.isPlaying=!1,this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null)}pause(){this._pause(),this.emitHook("pause")}resetFrame(){this.frame=0,this.startTime=performance.now()}reset(){this.resetFrame(),this.textures.forEach(t=>{t.history&&(t.history.writeIndex=0,this.clearHistoryTextureLayers(t))}),this.clear(),this.emitHook("reset")}destroy(){this.emitHook("destroy"),this._pause(),this.cursorTarget&&(this.eventListeners.forEach((e,i)=>{this.cursorTarget.removeEventListener(i,e)}),this.eventListeners.clear()),this.resolutionObserver&&(this.resolutionObserver.disconnect(),this.resolutionObserver=null),this.program&&(this.gl.deleteProgram(this.program),this.program=null),this.intermediateFbo&&(this.gl.deleteFramebuffer(this.intermediateFbo),this.intermediateFbo=null),this.textures.forEach(e=>{this.textureUnitPool.free.push(e.unitIndex),this.gl.deleteTexture(e.texture)}),this.textures.clear();let t=F.get(this.canvas);t&&(t.instances.delete(this),t.instances.size===0&&F.delete(this.canvas)),this.vao&&(this.gl.deleteVertexArray(this.vao),this.vao=null),this.buffer&&(this.gl.deleteBuffer(this.buffer),this.buffer=null),this.uniforms.clear(),this.hooks.clear()}},C=A;export{C as a};
//# sourceMappingURL=chunk-ZDI2D5RQ.mjs.map